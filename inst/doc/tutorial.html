<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jonas Moss" />

<meta name="date" content="2020-09-30" />

<title>Tutorial for kdensity</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Tutorial for <code>kdensity</code></h1>
<h4 class="author">Jonas Moss</h4>
<h4 class="date">2020-09-30</h4>



<div id="basic-usage" class="section level1">
<h1>Basic usage</h1>
<p><code>kdensity</code> is called using a syntax similar to <code>stats::density</code>, but with some additional arguments. A call to <code>kdensity</code> returns a density function (with class <code>kdensity</code>), which can be used as ordinary <code>R</code>-functions.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">library</span>(<span class="st">&quot;kdensity&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>kde =<span class="st"> </span><span class="kw">kdensity</span>(mtcars<span class="op">$</span>mpg, <span class="dt">start =</span> <span class="st">&quot;gumbel&quot;</span>, <span class="dt">kernel =</span> <span class="st">&quot;gaussian&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="kw">kde</span>(<span class="dv">20</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="co">#&gt; [1] 0.06829002</span></span></code></pre></div>
<p>Hence it can be used to calculate functionals, such as the expectation.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">integrate</span>(<span class="cf">function</span>(x) x<span class="op">*</span><span class="kw">kde</span>(x), <span class="dt">lower =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">upper =</span> <span class="ot">Inf</span>)<span class="op">$</span>value </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="co">#&gt; [1] 20.15896</span></span></code></pre></div>
<p>Plotting works as with <code>stats::density</code>. If <code>kdensity</code> was called with a parametric start, use <code>plot_start = TRUE</code> inside a plotting function in order to plot the estimated parametric start density instead of the kernel density.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">plot</span>(kde, <span class="dt">main =</span> <span class="st">&quot;Miles per Gallon&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="kw">lines</span>(kde, <span class="dt">plot_start =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="kw">rug</span>(mtcars<span class="op">$</span>mpg)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>If the R-package <code>magrittr</code> is installed, you can use pipes to plot.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">library</span>(<span class="st">&quot;magrittr&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>kde <span class="op">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">plot</span>(<span class="dt">main =</span> <span class="st">&quot;Miles per Gallon&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">lines</span>(<span class="dt">plot_start =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>The generics <code>coef</code>, <code>logLik</code>, <code>AIC</code> and <code>BIC</code> are supported, but work only on the parametric start.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="kw">coef</span>(kde)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="co">#&gt; Maximum likelihood estimates for the Gumbel model </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="co">#&gt;     mu   sigma  </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="co">#&gt; 17.321   4.865</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="kw">logLik</span>(kde)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a><span class="co">#&gt; &#39;log Lik.&#39; 1.644676 (df=2)</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="kw">AIC</span>(kde)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a><span class="co">#&gt; [1] 0.710647</span></span></code></pre></div>
<p>To view information about the kernel density, use the <code>summary</code> generic.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">summary</span>(kde)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span class="co">#&gt; Call: </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a><span class="co">#&gt; kdensity(x = mtcars$mpg, kernel = &quot;gaussian&quot;, start = &quot;gumbel&quot;)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a><span class="co">#&gt; Data:        mtcars$mpg (32 obs.)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a><span class="co">#&gt; Bandwidth:   2.742 (&#39;RHE&#39;)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a><span class="co">#&gt; Support:     (-Inf, Inf)</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a><span class="co">#&gt; Kernel:      gaussian</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a><span class="co">#&gt; Start:       gumbel</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a><span class="co">#&gt; Range:       (10.4, 33.9)</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a><span class="co">#&gt; NAs in data: FALSE</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a><span class="co">#&gt; Adjustment:  1</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a><span class="co">#&gt; Parameter estimates:</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true"></a><span class="co">#&gt; mu: 17.32</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true"></a><span class="co">#&gt; sigma: 4.865</span></span></code></pre></div>
<p>Access members of the kernel density with <code>$</code> or <code>[[</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a>kde<span class="op">$</span>start_str </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="co">#&gt; [1] &quot;gumbel&quot;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>kde[[<span class="st">&quot;x&quot;</span>]]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="co">#&gt;  [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2 10.4</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a><span class="co">#&gt; [16] 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4 15.8 19.7</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a><span class="co">#&gt; [31] 15.0 21.4</span></span></code></pre></div>
<p>To make changes to the kernel density estimator, you can use the generic <code>update</code> function, replace values with <code>$</code>, or make a new one.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>kde<span class="op">$</span>bw =<span class="st"> &quot;RHE&quot;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="kw">update</span>(kde, <span class="dt">start =</span> <span class="st">&quot;normal&quot;</span>)</span></code></pre></div>
<p><code>kdensity</code> supports all parametric starts implemented by the package <code>univariateML</code>. See <a href="https://github.com/JonasMoss/univariateML">its Github page</a> for a complete list, or take a look at <code>univariateML::univariateML_models</code>.</p>
</div>
<div id="custom-densities-and-kernels" class="section level1">
<h1>Custom densities and kernels</h1>
<div id="parametric-starts" class="section level2">
<h2>Parametric starts</h2>
<p>You must supply two functions and one vector to <code>kdensity</code> in order to use a custom parametric start. The first is a <code>density</code> function, the second is a function that estimates the named parameters of the density, and the third is the support of the density.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a>normal =<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>  <span class="dt">density =</span> dnorm,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>  </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a>  <span class="dt">estimator =</span> <span class="cf">function</span>(data) {</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a>    <span class="kw">c</span>(<span class="dt">mean  =</span> <span class="kw">mean</span>(data),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a>      <span class="dt">sd    =</span> <span class="kw">sd</span>(data))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a>  },</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a>  </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a>  <span class="dt">support   =</span> <span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>, <span class="ot">Inf</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a>)</span></code></pre></div>
<p>The density function must take the data as its first argument, and all its parameters must be named. In addition, the function <code>estimator</code> must return a vector containing named parameters that partially match the parameter names of the density function. For instance, the arguments of <code>dnorm</code> are <code>x, mean, sd, log</code>, where <code>log = TRUE</code> means that the logarithm of the density is returned. Since <code>estimator</code> returns a named vector with names <code>mean</code> and <code>sd</code>, the names are completely matched.</p>
<p>The estimator function doesnâ€™t need to be simple, as the next example shows.</p>
<div id="example-a-skew-hyperbolic-t-distribution-start" class="section level3">
<h3>Example: A skew hyperbolic t-distribution start</h3>
<p>The built-in data set <code>LakeHuron</code> contains annual measurements of the water level of Lake Huron from 1875 to 1972, measured in feet. We will take a look at the distribution of differences in water level across two consecutive years. Since the data are supported on the real line and there is no good reason to assume anything else, we will use a normal start.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a>LH =<span class="st"> </span><span class="kw">diff</span>(LakeHuron)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>kde_normal =<span class="st"> </span><span class="kw">kdensity</span>(LH, <span class="dt">start =</span> <span class="st">&quot;normal&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a><span class="kw">plot</span>(kde_normal, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>     <span class="dt">main =</span> <span class="st">&quot;Lake Huron differences&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The density is clearly non-normal. Still, it looks fairly regular, and it should be possible to model it parametrically with some success. One of many parametric families of distributions more flexible than the normal family is the <em>skew hyperbolic t-distribution</em>, which is implemented in the <code>R</code> package <code>SkewHyperbolic</code>. This package contains the density function <code>dskewhyp</code> and a maximum likelihood estimating function in <code>skewhypFit</code>. Using these functions, we make the following list:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>skew_hyperbolic =<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>  <span class="dt">density   =</span> SkewHyperbolic<span class="op">::</span>dskewhyp,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a>  </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>  <span class="dt">estimator =</span> <span class="cf">function</span>(x) {</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>    SkewHyperbolic<span class="op">::</span><span class="kw">skewhypFit</span>(x, <span class="dt">printOut =</span> <span class="ot">FALSE</span>)<span class="op">$</span>param</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>  },</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a>  </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>  <span class="dt">support   =</span> <span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>, <span class="ot">Inf</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>)</span></code></pre></div>
<p>Now we are ready to run <code>kdensity</code> and do some plotting. Note the <code>plot</code> option <code>plot_start = TRUE</code>. With this option on, the estimated parametric density is plotted without any non-parametric correction.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a>kde_skewhyp =<span class="st"> </span><span class="kw">kdensity</span>(LH, <span class="dt">start =</span> skew_hyperbolic)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="kw">plot</span>(kde_skewhyp, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a>     <span class="dt">main =</span> <span class="st">&quot;Lake Huron differences&quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a><span class="kw">lines</span>(kde_normal)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a><span class="kw">lines</span>(kde_skewhyp, <span class="dt">plot_start =</span> <span class="ot">TRUE</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a><span class="kw">rug</span>(LH)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAHgCAMAAABKCk6nAAAA0lBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmOpBmZgBmZmZmkJBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2kDq2kGa225C227a229u22/+2/7a2/9u2//++vr7bkDrbkGbbtmbbtpDb27bb29vb2//b/7bb////tmb/25D/27b//7b//9v///9v+NoGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAXPUlEQVR4nO2dCXvjthGG4dWuKyfbXNamTa/YTZo0ZtI226ZskjaWV+L//0vFSYKXzAMDDIbzPYnXpkgAxKsZDIYCJCoWaYnUDWDBigETFwMmLgZMXAyYuBgwcTFg4mLAxMWAiYsBExcDJi4GTFwMmLgYMHExYOJiwMTFgImLARMXAyYuBkxcDJi4GDBxMWDiYsDExYCJiwETFwMmLgZMXAyYuBgwcTFg4mLAxIUWcCmuHgYOF+LFD8MXnO/F9aP5d7+8WlW+Ken87Y0QH5ufy8tLLgbcL9+UdBRSt+bn8vKSiwGPlW8aMNKMfJQH4J8+lXb0gfpbAzgdxIu3EuW3Qlx9/GjPaQM2oOSJt7qorz7VV/z0GyFe/uHRFP+NvPxVU4dyxq++ri24UKZ79Vr/fPCqqgtrHfLK+lFe8/JzU2Ldvv/Ig1cfvY3Qb11lAVj7Sd3RzoWqXyU9pVfW4i4BVpIvml/0afbXphJ5mdEQYK8qV1jvkC2rML/fttpXuqKjd2MWgGWH/+qxerpRvSbB/UuiuKv0r2/tUXuWUx/w9dvqv+pcQ9kce/XW/q4l30T7R2Vzbgz2XbRXlSusfaguSxbzyeO7g6q9OUM2Y/9Y/ZhkMM8BsNLPf3vtwH1mOsrAk+dZu7gIWL0h3Piq/zHHZPe78bq+YACwX5UtrH/IlGWKKT/63j9DvvTq+1gd11EWgM9feOCcL5S91vKylwDrU5wP13+WzstbwC40K4YA+1WV/dq9slwd7TNM08zgH1s5AFb98+ovPx9qwLoTj6LpYntWbwx2LlSf4mgelcF1AbvfBgH7VdnC+occYOcS/DPefWp++2u8/nPKAbDBdHKAr79zLvHOv+BZwM9ZsH5xzILvOu3qHxqwYK997758bd+YkZUD4KMDaoKsH2RXyp5q4Bi1AZvLj8ID3BmD24CfG4P3nXb1D7k3oCrm+MHXvfZV5z+nCKMRA3a61dHvu/tmbDXEC3H1efXu4MyiC1iiVdd4gNtRdAewiaKLsSi6rqp5t3QOmbJkMR8/nnWc35yhQ2vlp9mCG3mA6/DJATYE7DzTGXobcB3ieIDb8+AOYDeBHQTsVeUK6x2yZRV1U70zvm1FC1GVA2AdRb/6urSTy3psffeFpFinhzqpyicZ13z0j0MLsMlk/dEU3wV8/u5GvPx8cAz2q6oL6x5yZelM1h/bZ+iD4gPOZLGCiwETFwMmLgZMXAyYuBgwcTFg4mLAxMWAiYsBExcDJi4GTFwMmLgYMHExYOJiwMTFgImLARMXAyYuBkxcDJi4GDBxMWDiYsDExYCJiwETFwMmLgZMXAyYuBgwcTFg4goMWLAiKRXgsMWxxsSAiYsBExcDJi4GTFwMmLgYMHExYOJiwJM0J2OASwz4ee3mpYRwiQFf1k5KwlU/UjdlmRjwRe0apW7KQjHgC2q41oizaLcvBjwuxVR4f+x0sJWyRQvEgEdlRl//z12G0TQDHpPH12DNkzADHlHNt/4psnTSDHhYxlqrysNZE07YrPliwINyKNs0FeJULVoqBjwoC7LbSkk4flvWiQEPaXTSmx9hBjygC0mN7Jw0Ax7QhaTVTptwRoEWA+7r4nxXO+mM5koMuK+L092dnRZHbdEKMeCerAGPvpyXCTPgnp7LZuyyMmEG3NUzBpybCTPgrp5PR2Zlwgy4own55qw+vsOAO9Jz4Gdat0Pb+r5AAJ8Ot5X+juvxryrH2kWTHhjlZMJwgEv1Lcynw9364mJqigHLk7A2vy8wwBZtOfJt9Fh7SBvwhLOwtr8nMMBPNxrwccRJI+2g3RzAWThqtuCWpn5kQxPOYi4MBFjl6veVC7dWFhdPzyY5mhM3DbjSjK8eZCA9whct4KmOd9f5wBZa8TzY1wzAuZgwA/Y02UNX+eQroQGXOUXRcz4Va00YtkEBFNmC52/AFlGzPvacy1SYXXSjeQsXMiHMgBtNS3I0Z2O8h56AAJ/vjSPO6WHDxCyWdzrCm+gJBnDp5r+jE2GEfTOPby4mDAL4fF9jzShVuQwwynDRE1Cqsn5ImM/DhtZ6/olXZDBTYgt2mr80NItsFtQYbE04ozF4CeAMTBgoijbPk4QYsV+kgOda44YBxy5uvdyS/nnX4PfRDNhqye4MOfhoBmy1wENn4aMZsNGcJ4X+VdjuoycGbLRw/xz8hBmw0ewsh7sM2410xYC15qex6uuQ3UlXDFhrbh7auxDZnXTFgLUWGnAGTxwYsNYKwMhnSgxYaekQXOGfCjNgpUWTYHcp7nQlA1ZaBRi3CTNgpQUPGrxrGTB8cevU2bx/7sWVQOyjGXC1ykOj99EMuFoJGHmugwFX64bgFXPoKGLAaw0YeT6aAa83QQYMX9wqrQeM6nbaYsDrLRC1j2bAAQwQ80SJAQcBvEOb62DAoQAjNWEGXK3JUzZFMGDQ4lZo5SzYloHWRzPgdWmsuhCsJsyAAwGuut9kiUQMOMAQXPvoEO0JLFDAdkvhUMWBaNWzYL8YNHfUFghgtzr4wj47aLojiIdGnK6EsWC7sD8PCw4S/aJNVwK56NNBre3fEGC0PhpsDC6uHnIAHMzysPpouCCrFLdZAA7UFKw+GjCKfrp5mQPgUC1BmuuAnCad78WmAKPMdWw90RESMMpcBzRg5Du+hwyNdDyOjnBkC8a243uoSZIpC6OP3riLDgsYo49mwOFaYp4sI7kzJyDAmez4vgsMGKEJwwDOZcf3kB66wpmuBAGczX7RwQEjuS9PQI8L6wQH7h3fg3ponOlKtmDM5QUQ1BhsTRj3GBzcpSL00WDPg3PY8T24R0Xoozc9Dw6PI8SHrMOKAQcuEVuugwEHLhFbrmPLgCEGTHQ+euOAgzcj0Mesw4kBBy8Ulwkz4OCFMmCA4pYIxpli89EbBwxSLIabq8WAwxeLKpvFgMMXi8qEGTBAuRjuzmm7gME8KS4fzYAhSkZwe04MGKJkRFNhBgxRcphdA4Jow4DhmsCAEQCGjITCftx6nbYMeBMmvF3AkHEQA0YBGLBwPD6aAcOUzoDDFjdbwATwmPBmAQOnItBks+YDPh3EPmK9QII2MDQJ6SUWXMp3/8iKlPD1AikC4OT3qLXQRa9mnPrmwe0rc8AG8ej6/YD1wgjegWIx4WWAj5LuXXW+H11bFq5eGEUYIZHE0QsAq5WDhuzY6u6Q9cIoEmAEhJdE0VcP0y6Rdj56amrAEerPFvAbA+2i+RYyBnv68NHfzGFhvTCKAhiFj14OeGyTQqVCuvBCWy/OLRyidD0OHz0XcNFsRjg+TdJ2+/SeAoxzE5Y4tpUl4MaCL+h0UPDP/6s2bcE4TBgmF127b4N6bXHBFanj6QKuShM+H0d3BE8NOEo1GJIdMwFLi6y/FGlFHisx4GjhbX6A49cLoaiAExOGBoxyx/eIgJOb8KJU5a161LAoD41jx/d4j2qzBFxcPz7d7Kti1WP/zQBOTXhJLvpOR8crnjTMqRdAMT9sIV1VjoALCfdSqhL3ju9xAScmvMRF79VXT54OF1w07h3fo35aKkPAciJ89XC+v8AX+X7R0QGnvFmQaRLyHd+jdnhqHw0CGLcFR56j5Qf42QAK+Y7v0QEnnSktCbImzI8w7/geeUjMDvDoE0CYesMrdsyTNtmxbB4csd7gip8mzQzwxQlS+HqDKwXghIQXjMHjT/Eh6g2u+LPSzADn/sA/waq/lI+Ft/fAPwngdCbMgCMo5UxpCWDppK8fi3WTpWSAUyzMFgkJLwmyrh5K9TQpz/XBKRbe5wVYJZpVhvni8+Bw9YZWkp0VJOBUhJclOhTgTD/RkQhwMhNebsHF8tXfc+oNrEQf91OA09zz4jG4XJfuSDUipQOcyIQXRtEXlnYHrjes0n1eN1WyY2Pz4JSA05gwA46lbACbXPSqCGtOvUGVcklFIhOeDbgwwVW5cq+7ZIB3SSqusgF8dMHV002GUXTSNVG7JDOlmYC9p/1Zrk1KuENoopnSTMBeBjrLVGVqwPHvezbg2jFnmapMDDiBCW8LcMo9nIXx0bFbwICjKY0JM+BoEknCrNmAm00YsgMsOzgl4DRh1pZSlSnTHEYJfPSGAKfe+kUpvglvCnD6L0KJb8IMOK6iz5SAAJf6Sx0qVBuhIQEc2YRhAKu9SM0uLXgAi/QxlhIJwGYLB/2lLJgAIzDg+MkOEMAuHVJcP+IBnDjNYUQEcL0JS7FnwC3JACvyTAloDLZYT4exfFeSREf6IVhEN2GwKNo46fM9HsA7BIDjm/CG5sEIPHQCE2bAcSVimzA0YCxBlupXDICVoppwZAtOtuO72lAQwRBsFDNfuREXLVCkOZximvBmAOPx0CQAY9vxHRfgmGEWUKID247vqIbgqCYMm6rEsl+0HoLRAI46UwJ92FBh2fEdl4fWgGOZ8DYsuEKS5jCKmuyAGoOtCWMZg1E8aagV04SBomh0O74jGoLjmvBG5sGYPLQDHMeEGXAKWcAxemErgDF5aKNIJrwFwHqShBJwhG7YDOCI9U2UBgzerg0AVp2IE3AME94IYHweuopkwtsAjHAIjhVI0wcscA7BdbIDuGlbAIxyCBaRTHgbgPF5aC+dBdsV9AFXyBLRTvqDh/AmvBHAMWubKgMYmjADTibtmxlwkMoQemgrcBPeAmCUQ7ATA14vnB7aCtqEiQM24xxmwNAmvAXAmD00uAlvADDmIbieC4P1B23AAmmeshZ8wpI64Aq5h3YmDNYhpAEL7B46ggkTB1zh9tAVPGEGnFgNYJh2kgashNtDV+DPHDYAOFZNK7SDi7MYMArBOWnygLF7aCswE6YOGP0QbAXmpOkCNg4vDw9dwUXS1AHnYcBuqgTQLSCAJ3x9ViTAmXhoAUcYxoJHdxFeVtwSiRyyHE6imQyHbjCQi/a+SDpEcQuUkwFDmjDUGHx027CEKW62sjLgystnJQt2Mguysoqhq/oztOGdNGnA2XhoK2vCQfuGKmCtfAzYCsBJQwNOuuN7doABCEe24Kg7vufmoSsNOPAwTNlF52bA3lwpXMsJA97lCDi4kwZLdCTd8T2zOZITBGEYwGl3fLdJjvwAQxAGAZx4v+jckhyNHOCAgRbQ06Q6T5lgx/d8DdhPaIUiTNCCrQFnCdgopJOGGoOtCScYg3M2YKeAhIGi6IQ7vudvwFVIwkTnwTnzDfv0nwGjU9hQmibgnPkGJkwS8C5vwEEJEwNMIsJqE15bVPATkxRXF2sTBZkDru9jPWFagN07P3e+ViEIkwJcTzCIADaE1w3DxADT4huCMCXAkbbYjiVRP3lYc0O0AEf7wrgYEjXh3QrClABH+zaxSPIJLy8k+IlJitMK/5HExApBmBBgiHUBqeUSN8sJUwG8M+ZLyEH7WkGYBmB1/zuActFoeaBFALAJM0XoYhHJfkRl0c1lD3jX4ksSsLAZukV3lzngnU31UOa7jnDWgHcucKbsn5XMcj1FePZyuowBu7jZbZhEl29V5y3nE84WcI3XFUiar9N8wpkC7uCNs94YgxThWYizBLxZvObD5rMIZwh4s3gd4FmE8wPs8420FwQiOcKTEecG2MMbba8PXFL3PINwXoAbvPG2ckGp6UacFWD3wMiQ3TBf+wafgjgjwO55vuO6Zb7TB6hsALuk86ap+hLTjBgIcOhdduwjI3cVU1aaFE/DAA68y06b7rYHX18G8GXPBgI47B4d3vNefSXzbWQ+KXxpe0gQwCF32WnTZbxdGcS7uICDWXCHbrX10HlQFrGXAWq9OrmYOXUG2WVn50eJbLkXJBrGvQ+GA0XRa3fZ2YkuXQZ8ScJn3H5OPrmIwC0ae8GNJ17czHCnyD2FwAlY+GriwrB10tdAr0EDnralv8e2+XtZhawYQdZ4KU7/ZkVSXMDzi1tTr3A/6odP+j+hI03hXhaVEO5fIVyeTLgXzDX2hCbeMycK4QWtrU931gGELUF0QwlRCf+XMbMbmdyG7z8GzIA9hXvYwIAHbywx4IAPGxjw4I2lBRzyYQMDHryxtIBDPmxgwIM3xhZcX8uAA5+oFHBLfwY8eGOJAQfc0p8BD95YasA46mXACQGzIikR4LkKUn2IQmg1BLC8FNWj6Vc0DQEsL0X1aPoVTUMAy0tRPZp+RdMQwPJSVI+mX9E0BLC8FNWj6Vc0DQEsL0X1aPoVTUMAy0tRPZp+RdMQwPJSVI+mX9E0BLA8FjIxYOJiwMTFgImLARMXAyYuBkxcDJi4GDBxMWDiYsDExYCJiwETV1rAejnqyCKJOXp6f2w96yQdhbh6SN6KcN3hKyng873s11Ls15ZzOowuWJ6io2zFcT3hla0I1x0tJQX8dHNXjW/oMlnHCyvSJ8isqSvW9uvKVlTBuqMtBGPwWuM5itux1ayTFKZf17aiKSjEaNEIAeBifb+sA/zew9oiArSiVoDu8JUe8OhS1DllrOkUYzIBDCcI4BDd4Ss54GOIoIIO4CDd4Ss14DBvWDIuOrT9pgNcmhlfueqGSjdtRBBkrW2F1rruGFRaC673hFipVV0baJoUAHCo7vCVeB4c6A27rmsDJTpWAw7WHb6SAi7NYvXk4U0ZJlW5FnCw7vCVOshiAYsBExcDJi4GTFwMmLgYMHExYOJiwMTFgImLARMXAyYuBkxcDJi4GDBxMWDiYsDExYCJiwETFwMmLgZMXAyYuBgwcTFg4mLAxMWAiYsBExcDJi4kgM/3Zl1PMfjNxHbt0NF+8WZ7CV7x3IKe9rqy5nvq9ZqzO/+L63tX+uW6BUzmO5T3fmtKv1Hn+ztZst4RyaxuPd+bhYvq3gp70fWjPOf0JugqpGGhAWxWtg8CLmTHmkW8lerfzjpPc0k5Tnhs4aDq4sMlwK1Vh2r9sP7DrBevvNaouo814XJfacC6mepwC3B9f7rw0S/aDic0gF/qfhsCfDqoVZWlfaW3UNtcYk4a1FLArXXDunyNqrWGULXGAHTri1VxT+//YKmqf4YBq13TpLGPNTqY0ADel7qbBgC39tDor6F1gFVfFcZXng5/Ohinqfzql1ffaDDqQHH9y6E5/tWNdJa/HH5/03X7lamqu/Jfoyr3/im1C3aAFf/Tbx89qsOA5TnNuxZQeABrRLYDnm68gdUCNgz6mwxZF+06WfnL00FtGSf/V2cfZTGqI9UWctIoTTX2uLFge3K33v7eHfqs4tfNfoOmNS0XbUE/a8FVc2ugwgNYv52HLNhaku7BAU9cuLCl0kGLOlufJX8xV8ohXHVk8bvrR8lMu1B33AC+rZoh3lN3952j5no6qCYWuhmuNV4w5g5ZqqUeg+vIqg6ybv1bAxUiwGrMuxBkacADb3lzidt+6Ki8rbZS+cNYnxlrT2++ev8HeUC95h+vT+5V299e6XzvmleXoFsg/3BDhyvIUb2rLlnwhcghlBABVr02PE2S7/sX/3wzEoTZQ6qX5cj64u83DbOyxlDcPn34y5sH6T/Va+UkwAPbK9W0rQ/QVbfGameT+oaebvYVA9aygcrt0BhspPfqHeoQe4nsYN25TzcDFizd/3f7qvjk3rw2asHtMbi/vVLtUjV825qWpTcWrG7o2JsHbxvw03uvR8NKHXAOjVnOgq8fNbej56ItIuXh3//stirVVKwZg8tnLLg1TTKXHO27yLxFbGu8I70xWI0uFwBvawyulC8enAfvL+036MbgO2u80mhqZia+dXH1UUdi6jV3XOEYBdxOdKhqNPLC+BqvNf4Y3ImiVUjGUXTV6o/+iyo5aHpiaDs6L1Wps4k2OLYk9Xz3wYNw8ubBD+od9csoYJedtOOHy0fWv9StKbyN2q0lO6qluB1KVVqw25kH09GF1Paqc5eKAYeWn+l6RhvKRRPS9ATzlp4msaDEgImLARMXAyYuBkxcDJi4GDBxMWDiYsDExYCJiwETFwMmLgZMXAyYuBgwcTFg4mLAxMWAiYsBExcDJi4GTFz/B8M2ugad52NBAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>Since all the curves are in agreement, kernel density estimation appears to add unnecessary complexity without sufficient compensation in fit. We are justified in using the skew hyperbolic t-distribution if this simplifies our analysis down the line.</p>
</div>
</div>
<div id="kernels" class="section level2">
<h2>Kernels</h2>
<p>If you want to make custom kernel, you will need to supply the kernel function, with arguments <code>y, x, h</code>. Here <code>x</code> is the random data you put into <code>kdensity</code>, <code>h</code> is the final bandwidth, and <code>y</code> is the point you want to evaluate at. The kernel is called as <code>1/h*kernel(y, x, h)</code>, and should be able to take vector inputs <code>x</code> and <code>y</code>. In addition to the kernel function, you must supply a <code>support</code> argument, which states the domain of definition of the kernel. For instance, the <code>gcopula</code> kernel is defined on <code>c(0, 1)</code>. In addition, you can optionally supply the standard deviation of the kernel. This is only used for symmetric kernels, and is useful since it makes them comparable. For example, the implementation of the <code>gaussian</code> kernel is</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a>gaussian =<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>  <span class="dt">kernel  =</span> <span class="cf">function</span>(y, x, h) <span class="kw">dnorm</span>((y<span class="op">-</span>x)<span class="op">/</span>h),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>  <span class="dt">sd      =</span> <span class="dv">1</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>  <span class="dt">support =</span> <span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>, <span class="ot">Inf</span>))</span></code></pre></div>
<p>Custom kernels can be complicated, and do not have to be symmetric.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
